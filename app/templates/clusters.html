{% extends "layout/base.html" %}

{% block head %}

<style>
  .bottom-three {
     margin-top: 0.75cm;
  }

</style>





<head>
	<script type="text/javascript" src="{{ url_for('static', filename='js/jquery-1.8.2.min.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='js/d3.v2.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='js/d3.ay-pie-chart.js') }}"></script>
	
	<script type="text/javascript">
	var get_data	= function()
	{
		var data	= [];
		data.push({index: 1, name: "Carbs", value: {{chart_data[0]}} })
		data.push({index: 2, name: "Fat", value: {{chart_data[1]}} })
		data.push({index: 3, name: "Protein", value: {{chart_data[2]}} })
		return data;
	}
	
	$(function(){
		ay.pie_chart('pie-b', get_data(), {radius_inner: 30});
	});
	</script>
	
	<style>
	html, body { margin: 0; padding: 0; }
		
	.container { overflow: hidden; margin: 0px; }
	
	.chart { float: left; width: 300px; height: 300px; background: #eee; margin: 0 0px 0 0; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
	
	svg { width: 100%; height: 100%; }
	
	path.g-1 { fill: #F78181; }
	path.g-2 { fill: #8181F7; }
	path.g-3 { fill: #81F781; }
	
	svg > g.label { text-anchor: middle; }
	
	svg > g.labels g.label { -moz-pointer-events: none; -webkit-pointer-events: none; -o-pointer-events: none; pointer-events: none; }
	svg > g.labels g.label rect { stroke: none; fill: #fff; fill-opacity: .75; shape-rendering: crispEdges; }
	svg > g.labels g.label text { font-size: 12px; text-anchor: left; }
	svg > g.labels g.label.active rect { fill-opacity: 1; }
	</style>

    <style>
      .bottom-three {
         margin-top: 0.75cm;
      }
    </style>

    <style>
        body {
          font: 10px sans-serif;
        }

        .bar rect {
          fill: steelblue;
          shape-rendering: crispEdges;
        }

        .bar text {
          fill: #fff;
        }

        .axis path, .axis line {
          fill: none;
          stroke: #000;
          shape-rendering: crispEdges;
        }
    </style>
    
    <script src="http://d3js.org/d3.v3.min.js"></script>

</head>

{% endblock %}




{% block content %}

<p class="bottom-three">What's for Dinner</p>



<body>
	<div class="container-fluid">
        <div style="width:600px; margin:0 auto;">
            <h4><li>Select a cuisine type to calculate a pie chart breakdown of average dinner calorie sources for dinners generated from that cuisine cluster.</li></h4>
            <h4><li>Select a nutrient category to calculate a histogram of average dinner content for that nutrient (and within the selected cuisine cluster).</li></h4>
        </div>
	    <div style="width:260px; margin:0 auto;">
            <form id='myform' method='POST' action='' role="form" class="form-inline form-small">
                <select name='cuisine_choice' id='cuisine_choice' class="form-control" onchange="this.form.submit()">
                    {% if cuisine_choice == "r" %}
                        <option value="r" selected="selected">Surprise Cuisine!</option>
                    {% else %}
                        <option value="r">Surprise Cuisine!</option>
                    {% endif %}
                    {% if cuisine_choice == "c" %}
                        <option value="c" selected="selected">Classic American</option>
                    {% else %}
                        <option value="c">Classic American</option>
                    {% endif %}
                    {% if cuisine_choice == "as" %}
                        <option value="as" selected="selected">American Southern</option>
                    {% else %}
                        <option value="as">American Southern</option>
                    {% endif %}
                    {% if cuisine_choice == "i" %}
                        <option value="i" selected="selected">Italian + Salad</option>
                    {% else %}
                        <option value="i">Italian + Salad</option>
                    {% endif %}
                    {% if cuisine_choice == "a" %}
                        <option value="a" selected="selected">Asian</option>
                    {% else %}
                        <option value="a">Asian</option>
                    {% endif %}
                    {% if cuisine_choice == "m" %}
                        <option value="m" selected="selected">Mexican</option>
                    {% else %}
                        <option value="m">Mexican</option>
                    {% endif %}
                    {% if cuisine_choice == "s" %}
                        <option value="s" selected="selected">Seafood</option>
                    {% else %}
                        <option value="s">Seafood</option>
                    {% endif %}
                    {% if cuisine_choice == "b" %}
                        <option value="b" selected="selected">Breakfast for Dinner</option>
                    {% else %}
                        <option value="b">Breakfast for Dinner</option>
                    {% endif %}
                </select>
                <select name='nutrient_choice' id='nutrient_choice' class="form-control" onchange="this.form.submit()">
                    {% if nutrient_choice == "calories" %}
                        <option value="calories" selected="selected">Calories</option>
                    {% else %}
                        <option value="calories">Calories</option>
                    {% endif %}
                    {% if nutrient_choice == "carbohydrates" %}
                        <option value="carbohydrates" selected="selected">Carbs (g)</option>
                    {% else %}
                        <option value="carbohydrates">Carbs (g)</option>
                    {% endif %}
                    {% if nutrient_choice == "fat" %}
                        <option value="fat" selected="selected">Fat (g)</option>
                    {% else %}
                        <option value="fat">Fat (g)</option>
                    {% endif %}
                    {% if nutrient_choice == "protein" %}
                        <option value="protein" selected="selected">Protein (g)</option>
                    {% else %}
                        <option value="protein">Protein (g)</option>
                    {% endif %}
                    {% if nutrient_choice == "sugar" %}
                        <option value="sugar" selected="selected">Sugar (g)</option>
                    {% else %}
                        <option value="sugar">Sugar (g)</option>
                    {% endif %}
                    {% if nutrient_choice == "fiber" %}
                        <option value="fiber" selected="selected">Fiber (g)</option>
                    {% else %}
                        <option value="fiber">Fiber (g)</option>
                    {% endif %}
                </select>
            </form>
	    </div>
	        <div style="width:300px; margin:0 auto;">
                <div class="chart">
                    <svg class="pie-b"></svg>
                </div>
            </div>
        </div>
	</div>
    
    <div class="container-fluid">
        <div style="width:900px; margin:0 auto;">
            <div class="container-fluid">
                <script>
                        // Generate a Bates distribution of 10 random variables.
                        // var values = d3.range(1000).map(d3.random.bates(10));
                        var values = {{hist_data}};
                        // A formatter for counts.
                        var formatCount = d3.format(",.0f");

                        var margin = {top: 10, right: 0, bottom: 30, left: 30},
                            width = 930 - margin.left - margin.right,
                            height = 340 - margin.top - margin.bottom;

                        var x = d3.scale.linear()
                            .domain([0, {{hist_bound}}])
                            .range([0, width]);

                        // Generate a histogram using twenty uniformly-spaced bins.
                        var data = d3.layout.histogram()
                            .bins({{hist_bin_thresholds}})
                            (values);

                        var y = d3.scale.linear()
                            .domain([0, d3.max(data, function(d) { return d.y; })])
                            .range([height, 0]);

                        var xAxis = d3.svg.axis()
                            .scale(x)
                            .orient("bottom");

                        var svg = d3.select("body").append("svg")
                            .attr("width", width + margin.left + margin.right)
                            .attr("height", height + margin.top + margin.bottom)
                            .style("height", "340px")
                            .append("g")
                            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

                        var bar = svg.selectAll(".bar")
                            .data(data)
                            .enter().append("g")
                            .attr("class", "bar")
                            .attr("transform", function(d) { return "translate(" + x(d.x) + "," + y(d.y) + ")"; });

                        bar.append("rect")
                            .attr("x", 1)
                            .attr("width", x(data[0].dx) - 1)
                            .attr("height", function(d) { return height - y(d.y); });

                        bar.append("text")
                            .attr("dy", ".75em")
                            .attr("y", 6)
                            .attr("x", x(data[0].dx) / 2)
                            .attr("text-anchor", "middle")
                            .text(function(d) { return formatCount(d.y); });

                        svg.append("g")
                            .attr("class", "x axis")
                            .attr("transform", "translate(0," + height + ")")
                            .call(xAxis);

                </script>
            </div>
        </div>
    </div>
</body>


{% endblock %}

{% block footer %}
    {% include "include/footer.html" %}
{% endblock %}
